define(["jquery","backbone","app/app"],function($,Backbone,app){var Router=Backbone.Router.extend({route:function(route,name,callback){Backbone.Router.prototype.route.apply(this,[route,name,function(){if($.isFunction(this.resolve)){var arg=arguments,self=this;this.resolve.call(this,name,function(){$.isFunction(self.before)&&self.before.call(self,name);callback.apply(self,arg);$.isFunction(self.after)&&self.after.call(self,name)})}else{$.isFunction(this.before)&&this.before.call(this,name);callback.apply(this,arguments);$.isFunction(this.after)&&this.after.call(this,name)}}])}});app.router=new Router;return app.router});